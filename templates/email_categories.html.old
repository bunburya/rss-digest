<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: sans-serif;
            margin: 5%;
            background: rgb(250, 250,250) none repeat scroll 0% 0%;
            color: rgb(7, 3, 66);
        }
        .content_container {
            word-wrap: break-word;
            width: 100%;
            background: rgba(68, 18, 18, 0.08) none repeat scroll 0% 0%;
        }
        .category_title {
            font-size: 1.1em;
            margin-top: 2px;
            margin-bottom: 2px;
            padding: 10px;
            background: rgba(145, 145, 209, 0.8);
        }
        .feed_title, .entry, .more_entries {
            margin-top: 2px;
            margin-bottom: 2px;
            padding: 10px;
            background: rgba(184, 184, 209, 0.8);
        }
        .feed_title a {
            color: rgb(7, 3, 66);
            text-decoration: none;
        }
    </style>
</head>

<body>

    Hi {{ name }},
    
    <p>This is your RSS feed digest for {{ date }}.
    
    {% if last_update %} Since your last update on {{ last_update }}, there
    {% else %} There {% endif %} ha{{ 's' if new_entries_total == 1 else 've' }}
    been {{ new_entries_total }} new post{{ 's' if new_entries_total > 1 }} to
    {{ updated_feeds_count }} of your {{ subscribed_feeds_count }} subscribed
    feeds.</p>
            
    <div class="content_container">
        
    {% for c in categories %}
    
        <div class="category_container">
        
            <div class="category_title"><b>
                {% if c is none %} [Uncategorised] {% else %} {{ c }} {% endif %}
            </b></div>
    
            {% for f in non_empty_feeds %}
            {% if f['rss-digest-data']['category'] == c %}
                
                <div class="feed_title">
                    <b><a href="{{ get_feed_url(f) }}">{{ f['rss-digest-data']['title'] }}</a></b> - {{ new_entries_count(f) }}
                    new entr{{ 'ies' if new_entries_count(f) > 1 else 'y' }}
                </div>
                
                {% for e in f.entries[:max_feed_posts] %}
                
                <div class="entry">
                    <a href="{{ e.link }}" style="color: rgb(140, 60, 60);">
                    {{ e.title }}</a> (submitted by {{ get_author(e) }}
                    on {{ get_date(e) }})
                </div>
                
                {% endfor %}
                        
                {% if max_feed_posts and (new_entries_count(f) > max_feed_posts) %}
    
                <div class="more_entries">
                    {{ new_entries_count(f) - max_feed_posts  }} more new posts
                    at <a href="{{ get_feed_url(f) }}" style="color: rgb(140, 60, 60);">
                    {{ f['rss-digest-data']['title'] }}</a> 
                </div>
                
                {% endif %}
                
            {% endif %}
            {% endfor %}
                                
        </div>
        
    {% endfor %}
    
    </div>
            
    {% if empty_feeds %}
    <p>
        {% if len(empty_feeds) == 1 %}
            {{ empty_feeds[0]['feed']['title'] }} has no new entries.
        {% else %}
            {{ len(empty_feeds) }} of your subscribed feeds have no new
            entries since your last update: {{ empty_feed_titles }}
        {% endif %}
    </p>
    {% endif %}
    
</body>

</html>
